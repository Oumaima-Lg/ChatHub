<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ChatHub - Salles de Discussion</title>
    <link rel="stylesheet" href="chat.css">
     <!-- la bib des emojis -->
    <script type="module" src="https://cdn.jsdelivr.net/npm/emoji-picker-element@1.6.2/index.js"></script>
</head>
<body>
    <div class="container">
        <!-- √âcran de connexion -->
        <div id="loginScreen" class="screen">
            <div class="login-form">
                <h1>üöÄ ChatHub</h1>
                <p class="subtitle">Rejoignez des conversations en temps r√©el</p>
                
                <input type="text" id="usernameInput" placeholder="Entrez votre pseudonyme" maxlength="20">
                <input type="text" id="serverInput" placeholder="Adresse du serveur (localhost:3000)" value="localhost:3000">
                
                <div class="sound-settings">
                    <label class="sound-toggle">
                        <input type="checkbox" id="soundEnabled" checked>
                        <span>üîä Sons de notification activ√©s</span>
                    </label>
                </div>
                
                <button id="connectBtn" class="primary-btn">Se connecter</button>
                <div id="connectionStatus"></div>
                
                <div class="instructions">
                    <h3>üí° Instructions :</h3>
                    <ol>
                        <li>Assurez-vous que le serveur C est d√©marr√©</li>
                        <li>Assurez-vous que le proxy WebSocket est d√©marr√©</li>
                        <li>Entrez votre pseudonyme unique</li>
                        <li>Configurez vos pr√©f√©rences sonores</li>
                        <li>Cliquez sur "Se connecter"</li>
                    </ol>
                </div>
                <br />
                <div class="back-to-home">
                    <a href="index.html">‚Üê Retour √† la page d'accueil</a>
                </div>
            </div>
        </div>

        <!-- √âcran de s√©lection de salle -->
        <div id="roomScreen" class="screen hidden">
            <div class="room-form">
                <div class="room-header">
                    <h1>üè† Choisir une salle</h1>
                    <p class="welcome-text">Bienvenue <span id="welcomeUsername"></span> !</p>
                </div>
                
                <!-- Salle publique -->
                <div class="room-option public-room">
                    <div class="room-icon">üåç</div>
                    <div class="room-content">
                        <h3>Salle publique</h3>
                        <p>Rejoignez la salle de discussion g√©n√©rale ouverte √† tous</p>
                        <button id="joinPublicBtn" class="room-btn public">
                            <span>Rejoindre la salle publique</span>
                            <i>‚Üí</i>
                        </button>
                    </div>
                </div>

                <!-- Cr√©er une salle priv√©e -->
                <div class="room-option private-room">
                    <div class="room-icon">üîê</div>
                    <div class="room-content">
                        <h3>Cr√©er une salle priv√©e</h3>
                        <p>Cr√©ez votre propre salle s√©curis√©e par mot de passe</p>
                        <div class="input-group">
                            <input type="text" id="roomNameInput" placeholder="Nom de la salle" maxlength="30">
                            <input type="password" id="roomPasswordInput" placeholder="Mot de passe" maxlength="50">
                        </div>
                        <button id="createRoomBtn" class="room-btn create">
                            <span>Cr√©er la salle</span>
                            <i>+</i>
                        </button>
                    </div>
                </div>

                <!-- Rejoindre une salle priv√©e -->
                <div class="room-option join-room">
                    <div class="room-icon">üîë</div>
                    <div class="room-content">
                        <h3>Rejoindre une salle priv√©e</h3>
                        <p>Entrez les informations d'une salle priv√©e existante</p>
                        <div class="input-group">
                            <input type="text" id="joinRoomNameInput" placeholder="Nom de la salle" maxlength="30">
                            <input type="password" id="joinRoomPasswordInput" placeholder="Mot de passe" maxlength="50">
                        </div>
                        <button id="joinPrivateBtn" class="room-btn join">
                            <span>Rejoindre la salle</span>
                            <i>üîì</i>
                        </button>
                    </div>
                </div>

                <!-- Liste des salles disponibles -->
                <div class="room-option rooms-list-section">
                    <div class="room-icon">üìã</div>
                    <div class="room-content">
                        <h3>Salles disponibles</h3>
                        <p>D√©couvrez les salles publiques actives</p>
                        <div id="roomsList" class="rooms-list">
                            <div class="loading-rooms">
                                <div class="spinner"></div>
                                <p>Chargement des salles...</p>
                            </div>
                        </div>
                        <button id="refreshRoomsBtn" class="room-btn refresh">
                            <span>Actualiser</span>
                            <i>üîÑ</i>
                        </button>
                    </div>
                </div>

                <button id="backToLoginBtn" class="back-btn">
                    <i>‚Üê</i>
                    <span>Retour √† la connexion</span>
                </button>
            </div>
        </div>

        <!-- Interface de chat -->
        <div id="chatScreen" class="screen hidden">
            <div class="chat-header">
                <div class="room-info">
                    <h2 id="roomTitle">Chat Room</h2>
                    <span id="roomType" class="room-type"></span>
                    <div class="room-stats">
                        <span id="onlineCount">0 en ligne</span>
                    </div>
                </div>
                <div class="user-info">
                    <div class="sound-control">
                        <label class="sound-toggle-chat">
                            <input type="checkbox" id="soundEnabledChat" checked>
                            <span></span>
                        </label>
                    </div>
                    <div class="user-badge">
                        <span id="currentUser"></span>
                    </div>
                    <button id="leaveRoomBtn" class="action-btn leave">
                        <i>üö™</i>
                        <span>Quitter</span>
                    </button>
                    <button id="disconnectBtn" class="action-btn disconnect">
                        <i>‚ö°</i>
                        <span>D√©connexion</span>
                    </button>
                </div>
            </div>

            <div class="chat-container">
                <!-- Liste des utilisateurs connect√©s -->
                <div class="users-panel">
                    <div class="panel-header">
                        <h3>üë• Utilisateurs</h3>
                        <span class="user-count-badge" id="userCount">0</span>
                    </div>
                    <ul id="usersList"></ul>
                    <button id="refreshUsers" class="refresh-users-btn">
                        <i>üîÑ</i>
                        <span>Actualiser</span>
                    </button>
                </div>

                <!-- Zone de messages -->
                <div class="messages-panel">
                    <div id="messagesContainer" class="messages-container"></div>
                    
                    <div class="message-input-container">
                        <div class="message-input">
                            <input type="text" id="messageInput" placeholder="Tapez votre message..." maxlength="500">
                            <button id="toggle-emoji" class="emoji-btn">üòä</button>
                            <button id="sendBtn" class="send-btn">
                                <i>üì§</i>
                            </button>
                        </div>
                        <div class="typing-indicator" id="typingIndicator"></div>
                        <div id="emoji-picker-container">
                            <emoji-picker id="picker" categories='["smileys", "people", "animals", "food", "activity", "travel", "objects", "symbols", "flags"]'></emoji-picker>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
</body>
</html>